generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mongodb"
  url      = env("DATABASE_URL")
}

model Route {
  id               String  @id @default(auto()) @map("_id") @db.ObjectId
  routeId          String  @map("route_id")
  routeName        String  @map("route_name")
  // route-level avg daily distance metrics (stored as JSON objects with dynamic keys)
  avgDailyDistance Json[]  @map("avg_daily_distance")
  // route-level starting points
  startingPoint    Json[]  @map("starting_point")
  stages           Stage[]

  @@map("routes")
}

type Stage {
  stageNumber    Int             @map("stage_number")
  stageName      String          @map("stage_name")
  distanceKm     Float           @map("distance_km")
  distanceMiles  Float           @map("distance_miles")
  gpx            String
  details        StageDetails
  facilities     Facility[]
  accommodations Accommodation[]
}

type StageDetails {
  totalDistance      String   @map("total_distance")
  totalTime          String   @map("total_time")
  accumulatedAscent  String   @map("accumulated_ascent")
  accumulatedDescent String   @map("accumulated_descent")
  walkingSurface     String[] @map("walking_surface")
  elevationProfile   String   @map("elevation_profile")
  challenges         String[]
  highlights         String[]
}

type Facility {
  index    Int
  name     String          @map("name")
  distance String          @map("distance")
  services ServiceLabels[]
}

type Accommodation {
  name          String
  priceCategory String  @map("price_category")
  contactUrl    String? @map("contact_url")
  contactPhone  String? @map("contact_phone")
  lat           Float?  @map("lat")
  long          Float?  @map("long")
}

enum ServiceLabels {
  Shop
  ATM
  Food_Drink
  Camino_Stamp
  Hotel
  Guest_House
  Supermarket
  Campsite
}
